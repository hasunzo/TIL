# 교착상태

# 교착상태의 개념

## 교착상태(deadlock)

- 2개 이상의 프로세스가 서로 상대방의 작업이 끝나기만을 기다리고 있는 상태
- 결과적으로 아무도 완료되지 못함
- 프로세스1 자원1 요구 → 사용 → 자원2 요구
- 프로세스2 자원2 요구 → 사용 → 자원1 요구
- 두 프로세스 각각 상대방의 작업이 끝나기만을 기다리고 있음

### 교착상태와 기아상태의 차이

- 교착상태
  - 영원히 기다릴 수 밖에 없음
- 기아상태
  - 기다리다보면 해소 될 가능성이 있음

## 교착상태의 특성

### 교착상태의 필요조건

- 네 가지의 조건이 동시에 만족될 경우 교착상태가 발생할 수 있음
  - 상호배제 조건
  - 점유 대기 조건
  - 비점 조건
  - 환형 대기 조건
- 상호배제 조건
  - 프로세스들이 자원에 대한 배타적인 통제권을 요구
  - 자원이 사용중이면 다른 프로세스들은 해당 자원을 쓸 수 없음
  - 적어도 하나 이상의 자원은 공동 사용될 수 없음
- 점유 대기 조건
  - 프로세스가 이미 다른 자원을 할당받아 배타적으로 점유하고 있는 상황에서
  - 다른 프로세스가 점유하고 있는 자원이 해제되기를 기다리는 상황
- 비선점 조건
  - 프로세스에 할당된 자원은 그 프로세스가 사용을 마치고 스스로 반환되기 전에 제거되지 않음
  - 다른 프로세스에 의해서는 해제되지 않음
- 환형 대기 조건
  - 프로세스의 자원 점유 및 점유된 자원의 요구 관계가 환형을 이루며 대기


### 자원할당 그래프 G = (V, E)

- 정점의 집합
  - n개의 프로세스
  - m개의 자원
- 방향 있는 간선의 집합
  - 프로세스가 자원을 요구함 (요구간선)
  - 자원이 프로세스에 할당됨 (할당간선)
- 교착상태와의 관계
  - 상호배제 조건 - 할당간선
  - 점유 대기 조건 - 할당간선
  - 비선점 조건 - 요구간선
  - 환형 대기 조건 - 사이클(cycle)
- 자원할당 그래프에 사이클이 없음 → 교착상태 발생 X
- 자원할당 그래프에 사이클 존재 → 교착상태 발생 O / X

### 교착상태 처리

- 교착상태 방지
  - 교착상태의 필요조건 중 하나라도 발생할 수 없도록 막음
- 교착상태 회피
  - 프로세스에 필요한 자원의 최대량에 대한 정보를 활용하여 교착상태가 발생하지 않도록 함
- 교착상태 탐지 및 복구
  - 교착상태가 발생하면 이에 따른 적절한 조치를 취하여 정상 상태로 복구

### 교착상태 방지

- 상호배제 조건의 제거
  - 공유할 수 있는 자원 : 상호배제와 무관
  - 공유할 수 없는 자원 : 반드시 상호배제 해야 함
  - 상호배제 조건을 제거하여 교착상태를 방지하는 것은 불가능
- 점유 대기 조건의 제거
  - 프로세스가 자원을 요청할 때 그 프로세스는 어떠한 자원도 할당받지 않은 상태여야 함